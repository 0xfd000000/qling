Qling, the Qt interface for cling
=================================

This is a simple Qt interface for cling, the llvm-based C++ interpreter

This is at a very early stage and definitely needs some love.
At the moment you need to hack some stuff into source files to get it to compile and run correctly, see Compiling...


Compiling
==========

First you need to install llvm, clang and cling from SVN. Follow the instructions at
http://root.cern.ch/drupal/content/cling-build-instructions

Install it to some folder, either system wide or somewhere in your home (speficy via the --prefix option to llvm's configure-script).
At the moment you need to specify that installation path at a few different places:
qling.pro
main.cpp

In both files you find mentions of "/home/thomas/opt/llvm-debug" - replace this with the installation path provided to llvm's configure script.

Then you need to enter the the directory qt-hack and compile qatomic_sun.s:

as qatomic_sun.s -o qatomic_sun.o

and change back to the qling directory.


After you've done this:

qmake
make

and

./qling

to start

This llvm-path-mess will definitely be fixed in the next commit, this is just hastily packed up and uploaded to get the sources out there.

Notes
=====

At the moment, llvm's JIT does not support inline assembler, which is needed for Qt's atomic stuff. For this reason there is a folder qt-hack, which includes modified qatomic-headers that #ifdef the inline asm away and cause the compiler to use the non-inline functions provided by qatomic_sun.s instead.
These inline-asm issues likely causes other libraries that you might want to use from within cling to make the app crash, as well. An example is Eigen3 - I do have a patched version of Eigen3, too but there is a more elegant way to go:
Recently the "MC framework" has been included in llvm and MC's JIT does support inline assembler. Unfortunately cling needs to be patched to make use of that and I have not yet been successful in making this work correctly - it segfaults atm which seems to be some JIT-memory-manager issue that I have yet to figure out. I have only spent ~1hour on this and then given up due to lack of time.




Have fun!

